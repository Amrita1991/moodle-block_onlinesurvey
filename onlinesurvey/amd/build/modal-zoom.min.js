define(["core/templates","core/str"],function(e,n){var t="",o="#surveys_content",r="",c="",a=0,i=function(){var e=document.getElementById("contentframe");if(e){var n=e.src;e.src="",e.src=n}},u=function(n){n.preventDefault();var o=n.target,r=o.querySelector("iframe"),c=e.render("block_onlinesurvey/modal-iframe",{src:r.src,title:t});c.done(function(e,n){var t=document.createElement("div");t.innerHTML=e;var o=t.firstChild;document.body.insertBefore(o,document.body.firstChild),document.body.className+=" custom-modal-open";var r=function(e){e.target;document.body.className=document.body.className.replace(" custom-modal-open",""),i(),o.className+=" fading",setTimeout(function(){null!==o.parentNode&&o.parentNode.removeChild(o)},250)};o.querySelector(".custom-modal_close-button").addEventListener("click",function(e){return e.preventDefault(),r(e)}),o.addEventListener("click",function(e){return e.preventDefault(),e.target!==o?!1:r(e)})})};return{init:function(e,n,t){r=e,c=n,a=t;for(var i=document.querySelectorAll(o),d=0;d<i.length;d++)i[d].addEventListener("click",u);window.EVASYS={generate_popupinfo:this.generate_popupinfo},window.evasys_generate_popupinfo=this.generate_popupinfo},generate_popupinfo:function(){var n=sessionStorage.getItem("onlinesurvey_popupinfo");if(0==n||null==n||n!=a){sessionStorage.setItem("onlinesurvey_popupinfo",a);var t=e.render("block_onlinesurvey/popupinfo",{title:r,content:c});t.done(function(e,n){var t=document.createElement("div");t.innerHTML=e;var o=t.firstChild;document.body.insertBefore(o,document.body.firstChild),document.body.className+=" custom-modal-open popupinfo";var r=function(e){e.target;document.body.className=document.body.className.replace(" custom-modal-open",""),o.className+=" fading",setTimeout(function(){null!==o.parentNode&&o.parentNode.removeChild(o)},250)};o.querySelector(".custom-modal_close-button").addEventListener("click",function(e){return e.preventDefault(),r(e)}),o.addEventListener("click",function(e){return e.preventDefault(),e.target!==o?!1:r(e)})})}}}});