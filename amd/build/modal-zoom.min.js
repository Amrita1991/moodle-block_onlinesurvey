define(["core/templates","core/str"],function(a){var b="",c="#block_onlinesurvey_surveys_content",d="",e="",f=0,g=function(){var a=document.getElementById("block_onlinesurvey_contentframe");if(a){var b=a.src;a.src="",a.src=b}},h=function(c){c.preventDefault();var d=c.target,e=d.querySelector("iframe"),f=null;null!==e?f=a.render("block_onlinesurvey/modal-iframe",{src:e.src+"&modalZoom=1",title:b}):(e=parent.document.querySelector("iframe"),f=a.render("block_onlinesurvey/modal-iframe",{src:e.src+"&modalZoom=1",title:b})),f.done(function(a){var b=document.createElement("div");b.innerHTML=a;var c=b.firstChild;document.body.insertBefore(c,document.body.firstChild),document.body.className+=" block_onlinesurvey_custom-modal-open";var d=function(){document.body.className=document.body.className.replace(" block_onlinesurvey_custom-modal-open",""),g(),c.className+=" fading",setTimeout(function(){null!==c.parentNode&&c.parentNode.removeChild(c)},250)};c.querySelector(".block_onlinesurvey_custom-modal_close-button").addEventListener("click",function(a){return a.preventDefault(),d(a)}),c.addEventListener("click",function(a){return a.preventDefault(),a.target===c&&d(a)})})};return{init:function(a,b,g){d=a,e=b,f=g;for(var i=document.querySelectorAll(c),j=0;j<i.length;j++)i[j].addEventListener("click",h);window.EVASYS={generate_popupinfo:this.generate_popupinfo},window.evasysGeneratePopupinfo=this.generate_popupinfo},generate_popupinfo:function(){var b=sessionStorage.getItem("onlinesurvey_popupinfo");if(0==b||null===b||b!=f){sessionStorage.setItem("onlinesurvey_popupinfo",f);var c=a.render("block_onlinesurvey/popupinfo",{title:d,content:e});c.done(function(a){var b=document.createElement("div");b.innerHTML=a;var c=b.firstChild;document.body.insertBefore(c,document.body.firstChild),document.body.className+=" block_onlinesurvey_custom-modal-open popupinfo";var d=function(){document.body.className=document.body.className.replace(" block_onlinesurvey_custom-modal-open",""),c.className+=" fading",setTimeout(function(){null!==c.parentNode&&c.parentNode.removeChild(c)},250)};c.querySelector(".block_onlinesurvey_custom-modal_close-button").addEventListener("click",function(a){return a.preventDefault(),d(a)}),c.addEventListener("click",function(a){return a.preventDefault(),a.target===c&&d(a)})})}}}});